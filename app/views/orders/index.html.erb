<div class="container">
  <h1 class='mb-3'>Pedidos</h1>

  <% if @orders.present? %>
    <% @orders.each do |event, orders| %>
    <div class="grid-item">
      <div class='card-content'>
      <div class='d-flex justify-content-between align-items-center'>
        <h2><%= event.title %></h2>
        <p><%= event.date.strftime("%d-%m-%Y") %></p>
      </div>
        <p><%= event.location %></p>

        <ol class='ps-0'>
          <% orders.each do |order| %>
            <li>
              <%= order.ticket.ticket_type %> - <%= humanized_money_with_symbol(order.ticket.price) %>
              <%= link_to 'Remover', order_path(order), data: { turbo_method: :delete, turbo_confirm: 'Tem certeza?' } %>
            </li>
          <% end %>
        </ol>
      </div>
    </div>

    <% end %>

    <h3>Preço total: <%= humanized_money_with_symbol(@total_price) %></h3>

    <%= form_with url: create_checkout_session_path, data: { turbo_method: :post, turbo: false }, local: true do %>
      <%= submit_tag 'Checkout', class: 'btn btn-primary mt-3' %>
    <% end %>

  <% else %>
    <p>Não há pedidos para processar!</p>
  <% end %>
</div>
